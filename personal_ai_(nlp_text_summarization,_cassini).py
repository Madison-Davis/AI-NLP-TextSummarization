# -*- coding: utf-8 -*-
"""Personal: AI (NLP: Text Summarization, Cassini).ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/11dxiT58QqDfHRkiS2yoNHKMTdGSGpNlK
"""

# Imports
!pip install transformers
nltk.download('stopwords')
nltk.download('punkt')
import nltk
import os
from nltk.corpus import stopwords
from nltk.tokenize import word_tokenize, sent_tokenize
from IPython.display import HTML, display
from transformers import pipeline

# Text
text_file = open("//content//drive//MyDrive//Coding//Personal Projects//1: Artificial Intelligence//Resources//Cassini_EOM_Text.txt")
text = text_file.read()
text = text.replace("\n", " ")
text = text.replace("\'", "")
text = text.replace('\"', "")
# print(text)
text = "After two decades in space, NASAs Cassini spacecraft is nearing the end of its remarkable journey of exploration. Having expended almost every bit of the rocket propellant it carried to Saturn, operators are deliberately plunging Cassini into the planet to ensure Saturns moons will remain pristine for future exploration - in particular, the ice-covered, ocean-bearing moon Enceladus, but also Titan, with its intriguing pre-biotic chemistry.  Beginning in 2010, Cassini began a seven-year mission extension in which it completed many moon flybys while observing seasonal changes on Saturn and Titan. The plan for this phase of the mission was to expend all of the spacecrafts propellant while exploring Saturn, ending with a plunge into the planets atmosphere. In April 2017, Cassini was placed on an impact course that unfolded over five months of daring dives - a series of 22 orbits that each pass between the planet and its rings. Called the Grand Finale, this final phase of the mission has brought unparalleled observations of the planet and its rings from closer than ever before. On Sept. 15, 2017, the spacecraft will make its final approach to the giant planet Saturn. But this encounter will be like no other. This time, Cassini will dive into the planets atmosphere, sending science data for as long as its small thrusters can keep the spacecrafts antenna pointed at Earth. Soon after, Cassini will burn up and disintegrate like a meteor. To its very end, Cassini is a mission of thrilling exploration. Launched on Oct. 15, 1997, the mission entered orbit around Saturn on June 30, 2004 (PDT), carrying the European Huygens probe. After its four-year prime mission, Cassinis tour was extended twice. Its key discoveries have included the global ocean with indications of hydrothermal activity within Enceladus, and liquid methane seas on Titan. And although the spacecraft may be gone after the finale, its enormous collection of data about Saturn - the giant planet itself, its magnetosphere, rings and moons - will continue to yield new discoveries for decades."

# Extraction Text Summarization
# Frequency of Words
stopWords = set(stopwords.words("english"))
words = word_tokenize(text)
freqTable = dict()
for word in words:
  word = word.lower()
  if word in stopWords:
    continue
  if word in freqTable:
    freqTable[word] += 1
  else:
    freqTable[word] = 1

# Assign Value to each Sentence
sentences = sent_tokenize(text)
sentenceValue = dict()
for sentence in sentences:
  for word, freq in freqTable.items():
    if word in sentence.lower():
      if sentence in sentenceValue:
        sentenceValue[sentence] += freq
      else:
         sentenceValue[sentence] = freq

# Average Sentence Value
sumValues = 0
for sentence in sentenceValue:
  sumValues += sentenceValue[sentence]
average = int(sumValues/len(sentenceValue))

# Choose Sentences over Average
summary = ""
for sentence in sentences:
  if (sentence in sentenceValue) and (sentenceValue[sentence] > (1.2 * average)):
    summary += " " + sentence   
print(summary)

# Abstractive Text Summarization
os.environ["CUDA_VISIBLE_DEVICES"] = "0"
summarizer = pipeline("summarization")
summary = summarizer(text)[0]["summary_text"]
print(summary)